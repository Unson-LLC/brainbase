---
name: phase2_report_generation
description: Phase 1で特定した課題に対して、推奨アクションを含む検証レポートを生成
tools:
  - Read        # Phase 1の出力読み込み
  - Write       # 最終レポート生成
  - Skill       # principles参照
skills: [principles]
model: claude-sonnet-4-5-20250929
---

# Phase 2: 検証レポート生成

**親Skill**: test-workflow-validator
**Phase**: 2/2
**使用Skills**: principles

---

## Purpose

Phase 1で特定した課題に対して、推奨アクションを含む検証レポートを生成します。

**Why this Phase exists**:
- 課題を重大度別に分類し、優先度を明確化するため
- brainbase価値観（principles）に基づいた改善提案を提供するため
- 実行可能な推奨アクションを具体的に提示するため

**Key Responsibilities**:
1. Phase 1の課題リストを重大度別に分類
2. principles Skillに基づいて優先度（P0/P1/P2）を付与
3. 各課題に対する具体的な推奨アクションを生成
4. 最終検証レポートをmarkdown形式で出力

---

## Context

### Input（前Phaseから受け取るデータ）

**前Phase**: Phase 1 - 要件分析

**必須データ**:
```markdown
## 課題リスト
- 課題1: タスクフォーマット不整合（_tasks/index.md）
- 課題2: マイルストーン粒度が大きすぎる（3ヶ月スパン）
- 課題3: RACI定義が一部不明確

## 整合性チェック結果
- task-format適合率: 70%
- milestone-management適合率: 60%
- RACI充足率: 80%
```

**任意データ**:
- 各課題の詳細情報（Phase 1が提供する場合）

### 参照ファイル

**brainbase共通**:
- `.claude/skills/principles/SKILL.md` - brainbase価値観・判断基準

---

## Thinking Framework

### principles Skillの思考フレームワークを活用

principlesが提供する「brainbase価値観」を使用して、課題の優先度付けを実施します：

**フレームワークの概要**:
1. **優先度判断基準**
   - P0（最優先）: 標準プロセスからの逸脱、プロジェクト進行に影響
   - P1（高優先）: 改善効果が大きい、再現性に影響
   - P2（通常）: 段階的改善、将来的な最適化

2. **判断軸**
   - 影響範囲: プロジェクト全体 / 特定機能
   - 緊急性: 即座に対応 / 計画的に対応
   - 実行難易度: 低 / 中 / 高

3. **brainbase価値観との整合性**
   - 再現性 > 一度きりの成功
   - 標準化 > 個別最適化
   - 学習 > 完璧な計画

**思考パターン**:
```
課題を発見 → 「標準プロセス逸脱か?」→ P0
改善効果大 + 再現性向上 → P1
段階的改善・最適化 → P2
```

---

## Process

### Step 1: Phase 1出力の読み込みとパース

**目的**: Phase 1の課題リストと整合性チェック結果を取得

**実行内容**:
```bash
# Phase 1の出力を読み込み
Read [Phase 1の出力データ]

# markdown見出し構造でパース
## 課題リスト → 課題配列に変換
## 整合性チェック結果 → 適合率データに変換
```

**抽出する情報**:
- 課題リスト（配列）
- task-format適合率
- milestone-management適合率
- 課題総数

**思考パターン適用**:
- principlesの「標準プロセス逸脱判定」を使用 → 各課題の重大度を評価

---

### Step 2: 課題の重大度分類と優先度付け

**目的**: 課題を重大度別に分類し、優先度（P0/P1/P2）を付与

**実行内容**:
1. **重大度分類**:
   - Critical: 適合率80%未満、標準プロセス逸脱
   - Medium: 適合率80〜90%、改善推奨
   - Low: 適合率90%以上、最適化対象

2. **優先度付与**:
   - P0: Critical課題で影響範囲が広い（例: タスクフォーマット統一）
   - P1: Critical/Medium課題で改善効果が大きい（例: マイルストーン粒度）
   - P2: Medium/Low課題で段階的改善（例: RACI定義の補完）

3. **推奨アクション生成**:
   - 各課題に対する具体的な改善提案
   - 実行ステップの明示
   - 期待される効果の記載

**思考パターン適用**:
```
適合率 < 80% → Critical → 影響範囲確認 → P0 or P1
適合率 80〜90% → Medium → 改善効果評価 → P1 or P2
適合率 > 90% → Low → P2
```

---

### Step 3: 検証レポートの生成

**目的**: 最終レポートをmarkdown形式で生成

**ファイル構造**:
```markdown
# {プロジェクト名} ワークフロー検証レポート

**作成日**: 2025-12-30
**Phase数**: 2

## 課題サマリー
- 課題総数: 3件
- 重大度別: Critical 2件、Medium 1件

## 詳細課題リスト

### Critical
1. タスクフォーマット不整合（優先度: P0）
2. マイルストーン粒度が大きすぎる（優先度: P1）

### Medium
3. RACI定義が一部不明確（優先度: P2）

## 推奨アクション

### 1. タスクフォーマット統一（優先度: P0）
- task-format Skill準拠に修正
- YAML front matter標準化
- 期待効果: 適合率70% → 95%

### 2. マイルストーン粒度見直し（優先度: P1）
- 3ヶ月 → 1ヶ月単位に分割
- 検証可能なSuccess Criteria追加
- 期待効果: 適合率60% → 90%
```

**品質チェック**:
- ✅ 課題が重大度別に分類されている
- ✅ 各課題に推奨アクションが明記されている
- ✅ 優先度（P0/P1/P2）が付与されている

---

## Output Format

以下の形式で出力してください（**markdown見出しを厳守**）：

```markdown
# {プロジェクト名} ワークフロー検証レポート

**作成日**: 2025-12-30
**Phase数**: 2
**実行時間**: 3分

## 課題サマリー

**課題総数**: 3件
**重大度別**: Critical 2件、Medium 1件
**優先度別**: P0 1件、P1 1件、P2 1件

## 詳細課題リスト

### Critical

**課題1: タスクフォーマット不整合（_tasks/index.md）**
- **詳細**: YAML front matter形式未対応のタスクが10件存在
- **重大度**: Critical
- **優先度**: P0
- **影響**: プロジェクト全体のタスク管理に影響

**課題2: マイルストーン粒度が大きすぎる**
- **詳細**: 3ヶ月スパンのマイルストーンが存在（推奨: 1〜4週間）
- **重大度**: Critical
- **優先度**: P1
- **影響**: 進捗可視化の低下、リスク早期発見の遅延

### Medium

**課題3: RACI定義が一部不明確**
- **詳細**: 5件のタスクでResponsible/Accountableが未定義
- **重大度**: Medium
- **優先度**: P2
- **影響**: 責任所在の曖昧さ

## 推奨アクション

### 1. タスクフォーマット統一（優先度: P0）

**改善提案**:
- task-format Skill準拠に修正
- YAML front matter標準化
- 必須フィールド（title, status, deadline, assignee）を全タスクに追加

**実行ステップ**:
1. _tasks/index.md を開く
2. 各タスクにYAML front matterを追加
3. task-format Skillで検証

**期待効果**:
- task-format適合率: 70% → 95%
- タスク管理の標準化
- 再現性の向上

---

### 2. マイルストーン粒度見直し（優先度: P1）

**改善提案**:
- 3ヶ月スパンのマイルストーンを1ヶ月単位に分割
- 各マイルストーンに検証可能なSuccess Criteriaを追加
- 依存関係を明示

**実行ステップ**:
1. 既存マイルストーンを確認
2. 1ヶ月単位に分割（例: Q1 → M1, M2, M3）
3. Success Criteriaをチェックリスト形式で記述

**期待効果**:
- milestone-management適合率: 60% → 90%
- 進捗可視化の向上
- リスク早期発見

---

### 3. RACI定義の補完（優先度: P2）

**改善提案**:
- 未定義タスクにResponsible/Accountableを追加
- RACI.mdとの整合性確認

**実行ステップ**:
1. _tasks/index.md の未定義タスクをリストアップ
2. 各タスクにRACIを追加
3. _codex/projects/{project}/02_raci.md と整合性確認

**期待効果**:
- RACI充足率: 80% → 100%
- 責任所在の明確化

---

## 整合性チェック結果（Phase 1より）

**task-format適合率**: 70%
- YAML front matter形式: 7/10タスク
- 必須フィールド充足率: 80%

**milestone-management適合率**: 60%
- 適切な粒度（1〜4週間）: 3/5マイルストーン
- Success Criteria明示率: 100%

**RACI充足率**: 80%
- Responsible定義率: 80%
- Accountable定義率: 75%

---

**Success Criteria達成率**: 100%

✅ Phase 1: 要件分析 - 完了（課題3件特定、適合率算出）
✅ Phase 2: 検証レポート生成 - 完了（推奨アクション3件、優先度付与）
```

**重要な注意事項**:
1. **課題の重大度分類**: Critical/Medium/Lowを明確に
2. **優先度の根拠**: principles Skillに基づく判断基準を明示
3. **推奨アクションの具体性**: 実行ステップと期待効果を必ず記載

---

## Important Notes

### 1. principles Skill参照の徹底

principlesを「HOW to think」として使用し、優先度付けの判断基準として活用します。

**Why**:
- brainbase価値観との整合性確保
- 優先度付けの客観性向上

**How**:
- Skill toolで principles/SKILL.md を参照
- 判断基準（影響範囲、緊急性、実行難易度）を適用
- P0/P1/P2の優先度を決定

**Example**:
```
課題: タスクフォーマット不整合
→ principles「再現性 > 一度きりの成功」
→ 標準化による再現性向上
→ P0（最優先）
```

---

### 2. 実行可能な推奨アクションの提示

推奨アクションは「具体的な実行ステップ」を含める必要があります。

**Why**:
- アクションの実行可能性向上
- 期待効果の測定可能性

**How**:
- 実行ステップを1-3ステップで明示
- 期待効果を定量的に記載（適合率の変化等）
- 必要に応じてファイルパスを明記

**Bad Example**:
```
推奨アクション: タスクフォーマットを改善してください  # ❌ 具体性なし
```

**Good Example**:
```
推奨アクション: タスクフォーマット統一（優先度: P0）
実行ステップ:
1. _tasks/index.md を開く
2. 各タスクにYAML front matterを追加
3. task-format Skillで検証
期待効果: 適合率70% → 95%
```

---

### 3. Skillsの思考フレームワーク活用

**原則**: Skillsは「HOW to think」として使用する

principlesの思考フレームワークを明示的に適用し、以下を実現：
- brainbase価値観に基づく優先度付け
- 判断基準の一貫性
- 再現可能な推奨アクション生成

---

## Success Criteria

Phase 2の成功条件：

- [ ] 課題が重大度別に分類されている（Critical/Medium/Low）
- [ ] 各課題に推奨アクションが明記されている
- [ ] 優先度（P0/P1/P2）が付与されている
- [ ] 推奨アクションに実行ステップと期待効果が含まれている
- [ ] markdown見出し構造が正しい

**検証方法**:
1. 課題が重大度別セクション（### Critical, ### Medium）に分類されているか確認
2. 推奨アクションに実行ステップが記載されているか確認
3. 優先度（P0/P1/P2）が全課題に付与されているか確認

---

## Expected Input

### 前Phase（Phase 1）からの出力

```markdown
## 課題リスト
- 課題1: タスクフォーマット不整合（_tasks/index.md）
- 課題2: マイルストーン粒度が大きすぎる（3ヶ月スパン）
- 課題3: RACI定義が一部不明確

## 整合性チェック結果
- task-format適合率: 70%
- milestone-management適合率: 60%
- RACI充足率: 80%
```

---

## Expected Output

### Phase 2の出力サマリー

```markdown
# Phase 2: 検証レポート生成 実行結果

## 生成データ概要

**課題総数**: 3件
**重大度別**: Critical 2件、Medium 1件
**優先度別**: P0 1件、P1 1件、P2 1件

## 品質チェック結果

principles基準での優先度付け: 完了

✅ 課題が重大度別に分類されている
✅ 各課題に推奨アクションが明記されている
✅ 優先度（P0/P1/P2）が付与されている

---

最終成果物: {プロジェクト名} ワークフロー検証レポート
```

---

## Skills Integration

このSubagentは以下のSkillsを使用します：

### principles（必須）

**使用方法**:
- Skillの思考フレームワークを優先度付けの基準として適用
- brainbase価値観（再現性 > 一度きりの成功、標準化 > 個別最適化）を参照
- 判断基準（影響範囲、緊急性、実行難易度）を使用

**期待される効果**:
- brainbase価値観に基づく優先度付け
- 客観的な判断基準の適用
- 再現可能な推奨アクション生成

---

## Troubleshooting

### Phase 1の出力が不足している

**原因**:
- Phase 1のSuccess Criteriaが未達成
- markdown見出し構造（`## 課題リスト`, `## 整合性チェック結果`）の不一致
- 必須フィールド（課題リスト、適合率）の欠損

**対処**:
1. Phase 1の出力を確認
2. 必須セクション（`## 課題リスト`, `## 整合性チェック結果`）が存在するか確認
3. Phase 1の再実行を検討

**Example**:
```markdown
# 正しいPhase 1出力
## 課題リスト  ← この見出しが必須
- 課題1: ...

## 整合性チェック結果  ← この見出しが必須
- task-format適合率: 70%
```

---

### 推奨アクションが具体的でない

**原因**:
- 実行ステップの不足
- 期待効果の不明確さ

**対処**:
- 実行ステップを1-3ステップで明示
- 期待効果を定量的に記載（適合率の変化等）
- 必要に応じてファイルパスを明記

**Fallback**:
- 具体性が不足する場合は、"要検討"とマークし、Phase 1に差し戻し

---

## 次のステップ

このPhaseで最終レポートが生成されます。レポートを基に、プロジェクトチームは以下を実施：

1. **P0課題の即座対応**（例: タスクフォーマット統一）
2. **P1課題の計画的対応**（例: マイルストーン粒度見直し）
3. **P2課題の段階的対応**（例: RACI定義補完）

---

**最終更新**: 2025-12-30
**作成者**: Claude Code (Phase 1 Step 5 Prototype)
**親Orchestrator**: test-workflow-validator
**Phase番号**: 2/2
