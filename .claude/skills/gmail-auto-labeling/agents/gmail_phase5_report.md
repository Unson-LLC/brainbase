---
name: phase5-report
description: å‡¦ç†ã‚µãƒžãƒªãƒ¼ã‚’Markdownå½¢å¼ã§ç”Ÿæˆã€‚ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ¥ãƒ»ãƒ©ãƒ™ãƒ«åˆ¥çµ±è¨ˆã€å¤±æ•—è©³ç´°ã‚’å«ã‚€ã€‚
tools: [Read, Write]
skills: []
model: claude-haiku-4-5-20251001
---

# Phase 5: ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ

## Purpose

å…¨Phaseï¼ˆ1-4ï¼‰ã®çµæžœã‚’é›†ç´„ã—ã€Markdownå½¢å¼ã®å®Ÿè¡Œãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆã€‚

## Input

- `label_validation.json`: Phase 1ã®å‡ºåŠ›
- `fetched_messages.json`: Phase 2ã®å‡ºåŠ›
- `classification_results.json`: Phase 3ã®å‡ºåŠ›
- `apply_results.json`: Phase 4ã®å‡ºåŠ›

## Process

### Step 1: å…¨Phaseçµæžœã®èª­ã¿è¾¼ã¿

```bash
Read: /tmp/gmail-auto-labeling/label_validation.json
Read: /tmp/gmail-auto-labeling/fetched_messages.json
Read: /tmp/gmail-auto-labeling/classification_results.json
Read: /tmp/gmail-auto-labeling/apply_results.json
```

### Step 2: ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ¥çµ±è¨ˆã®ç®—å‡º

å„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ã¤ã„ã¦ï¼š
- å–å¾—ãƒ¡ãƒ¼ãƒ«æ•°ï¼ˆPhase 2ï¼‰
- åˆ†é¡žæˆåŠŸæ•°ï¼ˆPhase 3ï¼‰
- ãƒ©ãƒ™ãƒ«é©ç”¨æˆåŠŸæ•°ï¼ˆPhase 4ï¼‰
- ãƒ©ãƒ™ãƒ«åˆ¥é©ç”¨ä»¶æ•°

### Step 3: ãƒ©ãƒ™ãƒ«åˆ¥ãƒ»LLMå‡ºåŠ›çµ±è¨ˆã®ç®—å‡º

å…¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆè¨ˆã§ï¼š
- å„ãƒ©ãƒ™ãƒ«IDã®é©ç”¨ä»¶æ•°
- å‰Šé™¤ã•ã‚ŒãŸãƒ©ãƒ™ãƒ«ï¼ˆINBOX, UNREADç­‰ï¼‰ã®ä»¶æ•°
- ç·Šæ€¥åº¦åˆ¥ãƒ¡ãƒ¼ãƒ«æ•°ï¼ˆurgency: 1-5ï¼‰
- è¿”ä¿¡å¿…è¦ãƒ¡ãƒ¼ãƒ«æ•°ï¼ˆneedsReply: trueï¼‰

### Step 4: Markdownãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ

```bash
Write: /tmp/gmail-auto-labeling/report.md
```

## Output Format

```markdown
# Gmailè‡ªå‹•ä»•åˆ†ã‘ãƒ¬ãƒãƒ¼ãƒˆ

å®Ÿè¡Œæ—¥æ™‚: 2026-01-03 10:45:00

---

## å®Ÿè¡Œã‚µãƒžãƒªãƒ¼

- **ç·ãƒ¡ãƒ¼ãƒ«æ•°**: 285ä»¶
- **æˆåŠŸ**: 270ä»¶ï¼ˆ94.7%ï¼‰
- **å¤±æ•—**: 15ä»¶ï¼ˆ5.3%ï¼‰
- **å‡¦ç†æ™‚é–“**: ç´„4åˆ†30ç§’

---

## ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ¥è©³ç´°

### UNSON (info@unson.jp)

- **å–å¾—ãƒ¡ãƒ¼ãƒ«æ•°**: 100ä»¶
- **æˆåŠŸ**: 95ä»¶
- **å¤±æ•—**: 5ä»¶

#### é©ç”¨ãƒ©ãƒ™ãƒ«
| ãƒ©ãƒ™ãƒ«å | ä»¶æ•° |
|---------|------|
| dev/github | 30ä»¶ |
| finance/invoice | 20ä»¶ |
| dev/pr | 15ä»¶ |
| spam/promo | 10ä»¶ |
| business/contract | 5ä»¶ |

#### LLMåˆ†é¡žçµæžœ
| é …ç›® | å€¤ |
|------|-----|
| ç·Šæ€¥ãƒ¡ãƒ¼ãƒ«ï¼ˆurgency 4-5ï¼‰ | 5ä»¶ |
| è¿”ä¿¡å¿…è¦ãƒ¡ãƒ¼ãƒ«ï¼ˆneedsReply: trueï¼‰ | 12ä»¶ |
| å¹³å‡ç·Šæ€¥åº¦ | 2.3 |

---

### SALESTAILOR (k.sato@sales-tailor.jp)

- **å–å¾—ãƒ¡ãƒ¼ãƒ«æ•°**: 85ä»¶
- **æˆåŠŸ**: 80ä»¶
- **å¤±æ•—**: 5ä»¶

#### é©ç”¨ãƒ©ãƒ™ãƒ«
| ãƒ©ãƒ™ãƒ«å | ä»¶æ•° |
|---------|------|
| project/crm | 50ä»¶ |
| business/contract | 15ä»¶ |
| dev/vercel | 10ä»¶ |

#### LLMåˆ†é¡žçµæžœ
| é …ç›® | å€¤ |
|------|-----|
| ç·Šæ€¥ãƒ¡ãƒ¼ãƒ«ï¼ˆurgency 4-5ï¼‰ | 8ä»¶ |
| è¿”ä¿¡å¿…è¦ãƒ¡ãƒ¼ãƒ«ï¼ˆneedsReply: trueï¼‰ | 25ä»¶ |
| å¹³å‡ç·Šæ€¥åº¦ | 2.8 |

---

### TECHKNIGHT (sin310135@gmail.com)

- **å–å¾—ãƒ¡ãƒ¼ãƒ«æ•°**: 100ä»¶
- **æˆåŠŸ**: 95ä»¶
- **å¤±æ•—**: 5ä»¶

#### é©ç”¨ãƒ©ãƒ™ãƒ«
| ãƒ©ãƒ™ãƒ«å | ä»¶æ•° |
|---------|------|
| dev/github | 40ä»¶ |
| dev/pr | 20ä»¶ |
| dev/vercel | 15ä»¶ |
| spam/promo | 10ä»¶ |

#### LLMåˆ†é¡žçµæžœ
| é …ç›® | å€¤ |
|------|-----|
| ç·Šæ€¥ãƒ¡ãƒ¼ãƒ«ï¼ˆurgency 4-5ï¼‰ | 3ä»¶ |
| è¿”ä¿¡å¿…è¦ãƒ¡ãƒ¼ãƒ«ï¼ˆneedsReply: trueï¼‰ | 8ä»¶ |
| å¹³å‡ç·Šæ€¥åº¦ | 2.1 |

---

## å¤±æ•—è©³ç´°

| Account | MessageID | Error |
|---------|----------|-------|
| unson | xyz789 | Label not found: Label_999 |
| unson | def012 | Message not found |
| unson | ghi345 | Label not found: Label_888 |
| salestailor | abc123 | Label not found: Label_777 |
| salestailor | jkl456 | Message not found |
| techknight | mno789 | Label not found: Label_666 |

---

## LLMåˆ†é¡žçµ±è¨ˆï¼ˆå…¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆè¨ˆï¼‰

### ç·Šæ€¥åº¦åˆ¥åˆ†å¸ƒ
| ç·Šæ€¥åº¦ | ä»¶æ•° | å‰²åˆ |
|--------|------|------|
| 1ï¼ˆé€šçŸ¥ã®ã¿ï¼‰ | 120ä»¶ | 42.1% |
| 2ï¼ˆä½Žå„ªå…ˆåº¦ï¼‰ | 80ä»¶ | 28.1% |
| 3ï¼ˆä¸­å„ªå…ˆåº¦ï¼‰ | 45ä»¶ | 15.8% |
| 4ï¼ˆé«˜å„ªå…ˆåº¦ï¼‰ | 12ä»¶ | 4.2% |
| 5ï¼ˆç·Šæ€¥ï¼‰ | 3ä»¶ | 1.1% |

### è¿”ä¿¡å¿…è¦æ€§
- **è¿”ä¿¡å¿…è¦ãƒ¡ãƒ¼ãƒ«**: 45ä»¶ï¼ˆ15.8%ï¼‰
- **è¿”ä¿¡ä¸è¦ãƒ¡ãƒ¼ãƒ«**: 240ä»¶ï¼ˆ84.2%ï¼‰

### LLMåˆ¤æ–­ç†ç”±ã‚µãƒ³ãƒ—ãƒ«
| From | Subject | Reasoning |
|------|---------|-----------|
| notifications@github.com | Pull Request #123 opened | GitHub PRé€šçŸ¥ã€‚é–‹ç™ºé–¢é€£ã ãŒç·Šæ€¥æ€§ã¯ä½Žã„ã€‚è‡ªå‹•é€šçŸ¥ãªã®ã§è¿”ä¿¡ä¸è¦ã€‚ |
| sales@partner.com | ã€è¦æ‰¿èªã€‘å¥‘ç´„æ›¸é€ä»˜ã®ä»¶ | å¥‘ç´„æ›¸ç¢ºèªä¾é ¼ã§æ˜Žæ—¥æœŸé™ã€‚æ±ºè£ãŒå¿…è¦ãªãŸã‚ç·Šæ€¥åº¦4ã€‚äººé–“ã®åˆ¤æ–­ãŒå¿…é ˆã€‚ |
| newsletter@service.com | ã€æœŸé–“é™å®šã€‘50%OFFã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ | åºƒå‘Šãƒ¡ãƒ¼ãƒ«ã€‚spam/promoã«åˆ†é¡žã€‚ç·Šæ€¥åº¦ã¯æœ€ä½Žã€è¿”ä¿¡ä¸è¦ã€‚ |

---

## ã‚·ã‚¹ãƒ†ãƒ ãƒ©ãƒ™ãƒ«å‰Šé™¤çµ±è¨ˆ

| ãƒ©ãƒ™ãƒ« | å‰Šé™¤ä»¶æ•° |
|--------|---------|
| INBOX | 245ä»¶ |
| UNREAD | 180ä»¶ |

---

## æ¬¡å›žå®Ÿè¡Œæ™‚ã®æ”¹å–„ææ¡ˆ

1. **ç·Šæ€¥ãƒ¡ãƒ¼ãƒ«å„ªå…ˆ**: ç·Šæ€¥åº¦4-5ã®ãƒ¡ãƒ¼ãƒ«ï¼ˆ16ä»¶ï¼‰ã‚’å„ªå…ˆçš„ã«ç¢ºèª
2. **è¿”ä¿¡å¿…è¦ãƒ¡ãƒ¼ãƒ«**: needsReply=trueã®ãƒ¡ãƒ¼ãƒ«ï¼ˆ45ä»¶ï¼‰ã«è¿”ä¿¡
3. **å¤±æ•—ãƒ¡ãƒ¼ãƒ«å†è©¦è¡Œ**: æ¬¡å›žå®Ÿè¡Œæ™‚ã«è‡ªå‹•çš„ã«å†è©¦è¡Œï¼ˆ15ä»¶ï¼‰
4. **LLMåˆ†é¡žç²¾åº¦æ”¹å–„**: brainbaseã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®æ´»ç”¨ã§ã•ã‚‰ãªã‚‹ç²¾åº¦å‘ä¸Šã‚’æ¤œè¨Ž

---

Generated by: gmail-auto-labeling Orchestrator v1.0.0
```

## Success Criteria

- [âœ…] SC-1: Markdownãƒ¬ãƒãƒ¼ãƒˆç”ŸæˆæˆåŠŸ
- [âœ…] SC-2: ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ¥çµ±è¨ˆæ­£ç¢º
- [âœ…] SC-3: ãƒ©ãƒ™ãƒ«åˆ¥çµ±è¨ˆæ­£ç¢º
- [âœ…] SC-4: å¤±æ•—è©³ç´°ãƒ†ãƒ¼ãƒ–ãƒ«å‡ºåŠ›
- [âœ…] SC-5: ä¸è¶³ãƒ©ãƒ™ãƒ«è­¦å‘Šå«ã‚€

## Output to Orchestrator

**æˆåŠŸæ™‚**:
```
âœ… Phase 5å®Œäº†

ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆå®Œäº†:
- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ¥çµ±è¨ˆ: âœ…
- ãƒ©ãƒ™ãƒ«åˆ¥çµ±è¨ˆ: âœ…
- å¤±æ•—è©³ç´°: 15ä»¶è¨˜éŒ²
- ä¸è¶³ãƒ©ãƒ™ãƒ«è­¦å‘Š: å«ã‚€

Output: /tmp/gmail-auto-labeling/report.md

---
ðŸŽ‰ Gmailè‡ªå‹•ä»•åˆ†ã‘å®Œäº†ï¼

ç·ãƒ¡ãƒ¼ãƒ«æ•°: 285ä»¶
æˆåŠŸçŽ‡: 94.7%

è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆ: /tmp/gmail-auto-labeling/report.md
```

## Implementation Notes

### ãƒ‡ãƒ¼ã‚¿é›†ç´„ãƒ­ã‚¸ãƒƒã‚¯

```javascript
// æ“¬ä¼¼ã‚³ãƒ¼ãƒ‰
const stats = {
  byAccount: {},
  byLabel: {},
  byRule: {}
};

// ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ¥çµ±è¨ˆ
for (account in fetched_messages) {
  stats.byAccount[account] = {
    fetched: fetched_messages[account].length,
    classified: Object.keys(classification_results[account]).length,
    success: apply_results.byAccount[account].success,
    failed: apply_results.byAccount[account].failed
  };
}

// ãƒ©ãƒ™ãƒ«åˆ¥ãƒ»LLMçµ±è¨ˆ
const urgencyDistribution = [0, 0, 0, 0, 0, 0]; // index 0-5 for urgency 0-5
let replyNeededCount = 0;
const reasoningSamples = [];

for (account in classification_results) {
  for (messageId in classification_results[account]) {
    const result = classification_results[account][messageId];

    // ãƒ©ãƒ™ãƒ«çµ±è¨ˆ
    for (labelId of result.addLabelIds) {
      if (!stats.byLabel[labelId]) {
        stats.byLabel[labelId] = 0;
      }
      stats.byLabel[labelId]++;
    }

    // ç·Šæ€¥åº¦çµ±è¨ˆ
    if (result.urgency >= 1 && result.urgency <= 5) {
      urgencyDistribution[result.urgency]++;
    }

    // è¿”ä¿¡å¿…è¦æ€§çµ±è¨ˆ
    if (result.needsReply) {
      replyNeededCount++;
    }

    // åˆ¤æ–­ç†ç”±ã‚µãƒ³ãƒ—ãƒ«åŽé›†ï¼ˆæœ€å¤§3ä»¶ï¼‰
    if (reasoningSamples.length < 3 && result.reasoning) {
      reasoningSamples.push({
        from: fetched_messages[account][messageId].from,
        subject: fetched_messages[account][messageId].subject,
        reasoning: result.reasoning
      });
    }
  }
}
```

### Label ID â†’ Labelåã®é€†å¼•ã

`label_validation.json`ã®`existingLabelIds`ã‚’é€†å¼•ãï¼š

```javascript
// Label ID â†’ Labelåãƒžãƒƒãƒ—ä½œæˆ
const labelIdToName = {};
for (account in label_validation) {
  for (labelName in label_validation[account].existingLabelIds) {
    const labelId = label_validation[account].existingLabelIds[labelName];
    labelIdToName[labelId] = labelName;
  }
}
```

### Markdownãƒ†ãƒ¼ãƒ–ãƒ«ç”Ÿæˆ

```javascript
// ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ˜ãƒƒãƒ€ãƒ¼
let table = "| ãƒ©ãƒ™ãƒ«å | ä»¶æ•° |\n";
table += "|---------|------|\n";

// ãƒ‡ãƒ¼ã‚¿è¡Œ
for (labelId in stats.byLabel) {
  const labelName = labelIdToName[labelId] || labelId;
  const count = stats.byLabel[labelId];
  table += `| ${labelName} | ${count}ä»¶ |\n`;
}
```

### ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—

```javascript
const now = new Date();
const timestamp = now.toLocaleString('ja-JP', {
  year: 'numeric',
  month: '2-digit',
  day: '2-digit',
  hour: '2-digit',
  minute: '2-digit',
  second: '2-digit'
});
// "2026-01-03 10:45:00"
```

## Example Execution

### Input

**apply_results.json** (æŠœç²‹):
```json
{
  "summary": {
    "total": 285,
    "success": 270,
    "failed": 15,
    "successRate": 0.947
  },
  "byAccount": {
    "unson": {
      "success": 95,
      "failed": 5
    }
  },
  "failedMessages": [
    {
      "account": "unson",
      "messageId": "xyz789",
      "error": "Label not found: Label_999"
    }
  ]
}
```

### Process Log

```
[Phase 5] Starting Report Generation...
[Phase 5] Loading Phase 1 results (label_validation.json)...
[Phase 5] Loading Phase 2 results (fetched_messages.json)...
[Phase 5] Loading Phase 3 results (classification_results.json)...
[Phase 5] Loading Phase 4 results (apply_results.json)...

[Phase 5] Calculating account statistics...
[Phase 5] unson: 100 fetched, 95 success, 5 failed
[Phase 5] salestailor: 85 fetched, 80 success, 5 failed
[Phase 5] techknight: 100 fetched, 95 success, 5 failed

[Phase 5] Calculating label statistics...
[Phase 5] dev/github: 70ä»¶
[Phase 5] finance/invoice: 20ä»¶
[Phase 5] dev/pr: 35ä»¶
[Phase 5] spam/promo: 20ä»¶
[Phase 5] dev/vercel: 25ä»¶
[Phase 5] business/contract: 20ä»¶

[Phase 5] Calculating LLM statistics...
[Phase 5] Urgency distribution: 1=120, 2=80, 3=45, 4=12, 5=3
[Phase 5] Reply needed: 45ä»¶
[Phase 5] Average urgency: 2.1
[Phase 5] Collecting reasoning samples... 3ä»¶

[Phase 5] Generating Markdown report...
[Phase 5] Writing to /tmp/gmail-auto-labeling/report.md
[Phase 5] âœ… Complete
```

### Output

`/tmp/gmail-auto-labeling/report.md` (ä¸Šè¨˜ã®Markdownå½¢å¼)

## Review & Replan Considerations

### Criticalæ¡ä»¶ï¼ˆPhase 5å†å®Ÿè¡Œï¼‰

- ãƒ¬ãƒãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆå¤±æ•—
- çµ±è¨ˆè¨ˆç®—ã‚¨ãƒ©ãƒ¼ï¼ˆãƒ‡ãƒ¼ã‚¿ä¸æ•´åˆï¼‰

### Noneæ¡ä»¶ï¼ˆæ­£å¸¸çµ‚äº†ï¼‰

- ãƒ¬ãƒãƒ¼ãƒˆç”ŸæˆæˆåŠŸ
- å…¨çµ±è¨ˆãŒæ­£ç¢º
- Markdownæ§‹æ–‡æ­£ã—ã„

## Post-Execution Actions

ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆå¾Œã€Orchestratorã¯ä»¥ä¸‹ã‚’å®Ÿè¡Œï¼š

1. **ãƒ¬ãƒãƒ¼ãƒˆãƒ‘ã‚¹é€šçŸ¥**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒ¬ãƒãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’é€šçŸ¥
2. **ã‚µãƒžãƒªãƒ¼è¡¨ç¤º**: æˆåŠŸçŽ‡ã€ç·ãƒ¡ãƒ¼ãƒ«æ•°ç­‰ã‚’ç«¯çš„ã«è¡¨ç¤º
3. **æŽ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³æç¤º**: ä¸è¶³ãƒ©ãƒ™ãƒ«ä½œæˆç­‰ã®ææ¡ˆ

## Future Enhancements

- [ ] HTMLãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã§é–²è¦§ï¼‰
- [ ] Slackã¸ã®ãƒ¬ãƒãƒ¼ãƒˆé€ä¿¡
- [ ] éŽåŽ»ãƒ¬ãƒãƒ¼ãƒˆã¨ã®æ¯”è¼ƒåˆ†æž
- [ ] ã‚°ãƒ©ãƒ•ãƒ»ãƒãƒ£ãƒ¼ãƒˆç”Ÿæˆï¼ˆãƒ©ãƒ™ãƒ«åˆ¥æŽ¨ç§»ç­‰ï¼‰
