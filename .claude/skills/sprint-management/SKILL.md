---
name: sprint-management
description: brainbaseにおけるスプリント管理のルール。週次サイクル、mana自動処理、GMの責任（目標設定）、Learn昇格ルールを説明。スプリント運用時に使用。
---

## Triggers

以下の状況で使用：
- スプリント目標を設定するとき（月曜）
- スプリント振り返りを確認するとき（金曜）
- mana自動処理の仕組みを理解したいとき
- Learn昇格の判断をするとき

# スプリント管理ルール

## 1. スプリントとは何か

**「1週間の作業計画と振り返り」を管理する。**

毎週月曜に計画し、金曜に振り返る。チームの作業リズムを作る単位。

### Value Loopでの位置づけ

| Value Loop | スプリントの役割 |
|------------|-----------------|
| **Work（計画）** | 週次目標を設定し、タスクを洗い出す |
| **Work（実行）** | 日次で進捗を記録（mana自動） |
| **Learn** | 振り返りで学びを抽出し、次のDecisionに返す |

---

## 2. GMがやること vs manaがやること

### GMがやること（手動）

| タイミング | 作業 |
|-----------|------|
| **月曜AM** | 目標を設定（マイルストーンから逆算して2-3個） |
| **金曜PM** | manaが生成した振り返りを確認し、必要に応じて補足 |
| **金曜PM** | Learn昇格チェック（下記参照） |
| **金曜PM** | シップの品質確認 |

### manaがやること（自動）

| タイミング | 処理内容 |
|-----------|---------|
| **毎週金曜 18:00** | 来週のスプリントレコードを自動作成 |
| **毎日 21:00** | 日次ログを自動追記（完了タスク・進行中・ブロッカー・Slack活動） |
| **毎週金曜 18:00** | 日次ログを集約 → LLMで「完了事項」「ブロッカー」「学び」を自動生成 |

**原則**: GMの仕事は「目標を書く」だけ。それ以外はmanaが全部やる。

---

## 3. テーブル構造

| カラム | 型 | 記入者 | 説明 |
|--------|-----|--------|------|
| **期間** | SingleLineText | mana自動 | Sprint週の名前（例: W04） |
| **開始日** | Date | mana自動 | 週の開始日 |
| **終了日** | Date | mana自動 | 週の終了日 |
| **目標** | LongText | **GM手動** | 今週のフォーカス（2-3個） |
| **日次ログ** | LongText | mana自動 | 日々の作業サマリー |
| **完了事項** | LongText | mana自動 | 今週完了したこと |
| **ブロッカー** | LongText | mana自動 | 今週の障害 |
| **学び** | LongText | mana自動 | 振り返りで得た学び |
| **来週の予定** | LongText | mana自動 | 次週への引き継ぎ |

---

## 4. 目標の書き方

### ルール

- **2-3個に絞る**: 全部やろうとしない。フォーカスする
- **マイルストーンから逆算**: 「今週これが進めばゴールに近づく」を書く
- **具体的に書く**: 抽象的な表現を避ける

### Good Example

```
## 今週の目標（W04: 1/20〜1/26）

1. 認証機能のPRをマージする
2. 請求書テンプレートを完成させる
3. 週次レポートの自動配信を設定する
```

### Bad Example

```
## 今週の目標

- 開発進める ❌ 抽象的
- いろいろやる ❌ 具体性なし
- がんばる ❌ 目標になってない
- 5つの機能を実装、テスト、デプロイ、ドキュメント作成、レビュー ❌ 多すぎ
```

---

## 5. 週次サイクル

### 月曜AM: スプリント計画

```
1. 目標を設定（マイルストーンから逆算して2-3個）
2. タスクを洗い出し、優先度をつける
3. 今週出荷予定のシップをplannedで作成
```

**MCP操作例**:

```
# スプリントの目標を更新
mcp__nocodb__nocodb_update_record
  baseId: "pva7l2qlu6fdfip"
  tableName: "スプリント"
  recordId: "{current_sprint_id}"
  fields: {
    "目標": "1. 認証機能のPRをマージ\n2. 請求書テンプレート完成\n3. 週次レポート自動配信設定"
  }
```

### 毎日: タスク進行

```
1. タスクのステータスを更新する
2. 出荷したらシップをshippedに（出荷日+証跡URL必須）
3. ブロッカーがあればタスクに記録
```

**mana自動処理（21:00）**:
- 完了タスクを収集
- 進行中タスクのステータスを確認
- Slackの活動（メッセージ数等）を収集
- 日次ログに追記

### 金曜PM: スプリント振り返り

```
1. manaが自動で振り返りを生成
   - 完了事項・学び・ブロッカーをLLMが集約
   - 来週のスプリントレコードを自動作成
2. GMはマイルストーン進捗率を更新
3. シップの品質確認（出荷日・証跡URL）
4. Learn昇格チェック（下記参照）
```

---

## 6. Learn昇格ルール

スプリント振り返りで得た「学び」のうち、以下に該当するものは `_codex/` に昇格する（**必須**）。

### 昇格条件

| 条件 | 昇格先 | 例 |
|------|--------|-----|
| 再利用可能な判断基準 | `_codex/projects/{project}/decisions/` | 「APIはREST over GraphQLを選択する理由」 |
| 繰り返し発生する問題の対処法 | `_codex/common/operations/` | 「NocoDB APIのレート制限対策」 |
| チーム共通のルール変更 | `_codex/common/meta/raci/` 等 | 「レビュー必須の基準を変更」 |
| プロジェクト固有のノウハウ | `_codex/projects/{project}/` | 「〇〇クライアントの連絡ルール」 |

### 昇格しないもの

- 一時的な状況報告
- 個別タスクの進捗メモ
- 1回限りの事象

### 昇格フロー

```
1. 金曜: manaが学び候補を提示
2. GM: 昇格すべきか判断
3. GM: `_codex/` に記録（または指示）
4. コミット: _codex → brainbase-codex main直接
```

---

## 7. 命名規則

### Sprint週

- `W01`〜`W52`（年間通し番号）
- 年をまたぐ場合は `2026-W04` のように年付き

### 例

```
W04: 2026/1/20〜2026/1/26
W05: 2026/1/27〜2026/2/2
```

---

## 8. mana自動処理の詳細

### 日次ログ生成（毎日21:00）

```
## 2026-01-27（月）

### 完了タスク
- [完] ログイン画面実装（keigo）
- [完] パスワードリセット実装（keigo）

### 進行中
- [進] テスト作成（keigo）

### ブロッカー
- なし

### Slack活動
- #dev-brainbase: 15メッセージ
- #general: 3メッセージ
```

### 週次振り返り生成（毎週金曜18:00）

```
## W04 振り返り

### 完了事項
- 認証機能v1をリリース
- 請求書テンプレートを完成
- 週次レポート自動配信を設定

### ブロッカー
- 決済連携のAPI仕様が未確定（来週解消予定）

### 学び
- テストカバレッジを先に確保すると、後の修正が楽になる
- Slack通知は@mentionを活用すると見逃しが減る

### 来週の予定
- 決済連携の実装開始
- ユーザーマニュアル作成
```

---

## 9. トラブルシューティング

### manaが日次ログを生成しない

**原因**: manaのcron設定がオフになっている可能性

**対処**:
1. `launchctl list | grep mana` でmanaプロセスを確認
2. cron設定（GitHub Actions または launchd）を確認
3. 手動で `@mana /daily-log` を実行

### スプリントレコードが作成されない

**原因**: manaの金曜バッチが失敗

**対処**:
1. NocoDB APIの疎通確認
2. 手動でスプリントレコードを作成

```
mcp__nocodb__nocodb_create_record
  baseId: "pva7l2qlu6fdfip"
  tableName: "スプリント"
  fields: {
    "期間": "W05",
    "開始日": "2026-01-27",
    "終了日": "2026-02-02"
  }
```

---

## 10. 関連Skills

| Skill | 用途 |
|-------|------|
| **nocodb-4table-guide** | 4テーブル運用の全体像・MCP操作 |
| **ship-management** | シップの詳細運用 |
| **milestone-management** | マイルストーンの作成・更新 |

---

最終更新: 2026-01-27
