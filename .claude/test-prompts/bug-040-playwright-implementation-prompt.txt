以下の仕様に基づいて、BUG-040のPlaywrightテストを実装してください。

# テスト実装依頼

## 目的
初心者ナビゲーション 3/5「テンプレートを作成」完了後、自動的に4/5「プロジェクトを実行」に進むことを検証するPlaywrightテストを作成してください。

## 背景
- **修正内容**: `/api/templates` (GET) のレスポンス構造を `{ templates: [...] }` から `{ data: [...] }` に変更
- **修正PR**: https://github.com/Unson-LLC/salestailor/pull/819
- **期待動作**: テンプレートを1つ以上作成すると、初心者ナビゲーションが3/5から4/5に進む

## 実装要件

### 1. テストファイル作成
**ファイルパス**: `tests/e2e/basic/beginner-navigation-template-creation.spec.ts`

### 2. 必須テストケース

#### テストケース1: 基本シナリオ
```
テスト名: "初心者ナビゲーション: テンプレート作成後に4/5に進む"

手順:
1. 初心者ナビゲーション進行中のユーザーでログイン
   - プロフィール設定完了（1/5, 2/5完了）
   - テンプレート未作成（3/5未完了）
2. ダッシュボードに移動
3. 初心者ナビゲーションが「3/5 テンプレートを作成」を表示していることを確認
4. 「テンプレートを作成」ボタンまたはリンクをクリック
5. テンプレート作成ページに遷移
6. 最低限の必須フィールドを入力:
   - 基本情報タブ: テンプレート名（例: "E2Eテスト用テンプレート"）
   - メッセージ戦略タブ: デフォルト値を使用
   - 実行設定タブ: デフォルト値を使用
   - KPI設定タブ: 主要KPIを選択（例: openRate）
7. 「作成」または「保存」ボタンをクリック
8. テンプレート作成完了を待つ
9. ダッシュボードに戻る（ナビゲーション経由）
10. 初心者ナビゲーションが「4/5 プロジェクトを実行」に進んでいることを確認
11. 3/5が完了マークになっていることを確認

期待結果:
- ✅ ナビゲーションが4/5に進む
- ✅ 3/5に完了マーク（チェックマークなど）が表示される
- ✅ 4/5が現在のステップとして強調表示される
```

#### テストケース2: API レスポンス構造の検証
```
テスト名: "API レスポンス構造: { data: [...] } 形式を返す"

手順:
1. /api/templates (GET) のリクエストをインターセプト
2. レスポンスJSONを検証:
   - json.data が存在する
   - json.total が存在する
   - json.data が配列である
   - json.templates が存在しない（旧形式でないことを確認）

期待結果:
- ✅ 新しいレスポンス構造 { data: [...], total: number } を使用
- ✅ 旧構造 { templates: [...] } は使用されていない
```

#### テストケース3: ページリロード後の状態維持
```
テスト名: "初心者ナビゲーション: ページリロード後も4/5の状態を維持"

手順:
1. テストケース1を実行してナビゲーションを4/5に進める
2. ページをリロード（page.reload()）
3. 初心者ナビゲーションの状態を確認

期待結果:
- ✅ リロード後も4/5の状態が維持される
- ✅ 3/5が完了状態のまま
```

### 3. 実装ガイドライン

#### テストセットアップ
```typescript
import { test, expect } from '@playwright/test';

test.describe('BUG-040: 初心者ナビゲーション テンプレート作成', () => {
  test.beforeEach(async ({ page }) => {
    // 初心者ナビゲーション進行中のユーザーでログイン
    // プロフィール設定済み、テンプレート未作成の状態を準備
  });

  test.afterEach(async ({ page }) => {
    // テストで作成したテンプレートをクリーンアップ
  });

  // テストケースをここに記述
});
```

#### セレクター優先順位
1. `data-testid` 属性（推奨）
2. ラベルテキスト（`page.getByLabel('テンプレート名')`）
3. ロール（`page.getByRole('button', { name: '作成' })`）
4. テキスト（最終手段）

#### 待機処理
```typescript
// API レスポンスを待つ
await page.waitForResponse(response =>
  response.url().includes('/api/templates') && response.status() === 200
);

// 要素の表示を待つ
await page.waitForSelector('[data-testid="beginner-nav-step-4"]', { state: 'visible' });

// ナビゲーション完了を待つ
await page.waitForURL('**/dashboard');
```

### 4. 参考: 既存の関連ファイル

**確認すべきファイル**:
- `src/hooks/useUserProgress.ts` - 初心者ナビゲーションのロジック
- `src/app/dashboard/page.tsx` - ダッシュボードコンポーネント
- `src/app/templates/page.tsx` - テンプレート一覧ページ
- `tests/e2e/fixtures/auth.ts` - 認証ヘルパー（あれば）
- `tests/e2e/basic/` 配下の既存テスト - テストパターンの参考

**実装前の確認事項**:
1. 既存の初心者ナビゲーション関連テストがあるか確認
2. テストユーザーの作成方法を確認（既存のフィクスチャを利用）
3. ダッシュボードの初心者ナビゲーションUIのセレクターを確認
4. テンプレート作成フォームのフィールド名を確認

### 5. 実装手順

1. **既存コードの確認**
   ```bash
   # 初心者ナビゲーション関連のコンポーネントを探す
   find src -name "*.tsx" | xargs grep -l "初心者\|beginner\|progress" | head -5

   # useUserProgress の実装を確認
   cat src/hooks/useUserProgress.ts

   # 既存のE2Eテストを確認
   ls -la tests/e2e/basic/
   ```

2. **テストファイルの作成**
   ```bash
   # テストファイルを作成
   touch tests/e2e/basic/beginner-navigation-template-creation.spec.ts
   ```

3. **テストコードの実装**
   - 上記のテストケースをTypeScriptで実装
   - セレクターはページ構造に合わせて調整
   - エラーハンドリングを追加

4. **テストの実行と検証**
   ```bash
   # UIモードでデバッグ
   npx playwright test tests/e2e/basic/beginner-navigation-template-creation.spec.ts --ui

   # ヘッドレスで実行
   npx playwright test tests/e2e/basic/beginner-navigation-template-creation.spec.ts

   # 特定のテストケースのみ実行
   npx playwright test tests/e2e/basic/beginner-navigation-template-creation.spec.ts -g "テンプレート作成後に4/5に進む"
   ```

5. **問題があれば修正**
   - セレクターが見つからない場合は調整
   - タイミング問題があればwaitForを追加
   - エラーメッセージを確認して修正

## 実装時の注意事項

### セキュリティ
- テストユーザーの認証情報は環境変数または`.env.test`から読み込む
- 本番環境では実行しない

### パフォーマンス
- 不要な待機時間を避ける
- ページロード完了を適切に待つ
- APIレスポンスを待ってからアサーションを実行

### 保守性
- テストケースは独立して実行可能にする
- 共通処理はヘルパー関数に切り出す
- コメントで意図を明確にする

## 完了条件
- [ ] 3つのテストケースすべてが実装されている
- [ ] すべてのテストがローカル環境で成功する
- [ ] テストコードにコメントが適切に記載されている
- [ ] クリーンアップ処理が実装されている
- [ ] README またはコメントに実行方法が記載されている

## 質問・確認事項
実装中に不明点があれば、以下を確認してください:
1. 初心者ナビゲーションのUI構造が不明な場合 → 実際のページをブラウザで確認
2. セレクターが見つからない場合 → Playwright Inspector (`--debug`) で要素を確認
3. 認証方法が不明な場合 → 既存のE2Eテストを参照
4. テストが失敗する場合 → スクリーンショット・ビデオを確認

---

以上の仕様に基づいて、Playwrightテストを実装してください。
実装完了後、テスト実行結果のサマリーを報告してください。
