<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, viewport-fit=cover, interactive-widget=resizes-content">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>brainbase UI</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="stylesheet" href="style.css?v=20251224h">
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Noto+Sans+JP:wght@400;500;700&family=Noto+Sans+Mono:wght@400;500;700&display=swap"
        rel="stylesheet">
</head>

<body class="dark-theme">
    <div class="app-container">
        <!-- Left Navigation (Session List) -->
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h3 id="app-version" class="app-version">v0.1.86</h3>
            </div>

            <!-- Main Navigation -->
            <div class="sidebar-nav">
                <button class="nav-item active" id="nav-console-btn" title="„Ç≥„É≥„ÇΩ„Éº„É´">
                    <i data-lucide="terminal-square"></i>
                    <span>Console</span>
                </button>
                <button class="nav-item" id="nav-dashboard-btn" title="„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ">
                    <i data-lucide="layout-dashboard"></i>
                    <span>Dashboard</span>
                </button>
            </div>

            <!-- New Session Button (Desktop) -->
            <div class="add-session-container">
                <button class="add-session-btn" id="add-session-btn" title="Êñ∞Ë¶è„Çª„ÉÉ„Ç∑„Éß„É≥">
                    <i data-lucide="plus"></i>
                    <span>New Session</span>
                </button>
            </div>

            <div class="session-list" id="session-list">
                <!-- Sessions will be loaded dynamically -->
            </div>

            <!-- Archive Toggle -->
            <div class="archive-toggle-container">
                <button id="toggle-archived-btn" class="archive-toggle-btn">
                    <i data-lucide="archive"></i>
                    <span>„Ç¢„Éº„Ç´„Ç§„Éñ„ÇíË°®Á§∫</span>
                </button>
            </div>

            <!-- Settings Link -->
            <div class="sidebar-footer">
                <div class="sidebar-divider"></div>
                <!-- Inbox Notification -->
                <div class="inbox-trigger-container">
                    <button id="inbox-trigger-btn" class="inbox-trigger" style="display: none;">
                        <i data-lucide="bell"></i>
                        <span>ÈÄöÁü•</span>
                        <span class="inbox-badge" id="inbox-badge">0</span>
                    </button>
                    <!-- Inbox Dropdown -->
                    <div id="inbox-dropdown" class="inbox-dropdown">
                        <div class="inbox-dropdown-header">
                            <span>Êú™ÂØæÂøú„É°„É≥„Ç∑„Éß„É≥</span>
                            <button id="mark-all-done-btn" class="inbox-mark-all" title="„Åô„Åπ„Å¶Á¢∫Ë™çÊ∏à„Åø"
                                aria-label="„Åô„Åπ„Å¶„ÅÆÈÄöÁü•„ÇíÁ¢∫Ë™çÊ∏à„Åø„Å´„Åô„Çã">
                                <i data-lucide="check-check"></i>
                            </button>
                        </div>
                        <div id="inbox-list" class="inbox-dropdown-list">
                            <div class="loading">Ë™≠„ÅøËæº„Åø‰∏≠...</div>
                        </div>
                    </div>
                </div>
                <button id="settings-btn" class="settings-link">
                    <i data-lucide="settings"></i>
                    <span>Settings</span>
                </button>
            </div>
        </nav>

        <!-- Main Content (Console) -->
        <main class="main-content">
            <div class="console-area" id="console-area">
                <div class="console-toolbar">
                    <button id="paste-terminal-btn" class="console-btn" title="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Åã„Çâ„Éö„Éº„Çπ„Éà"
                        aria-label="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Åã„Çâ„Éö„Éº„Çπ„Éà">
                        <i data-lucide="clipboard"></i>
                    </button>
                    <button id="upload-image-btn" class="console-btn" title="ÁîªÂÉè„ÇíÈÅ∏Êäû„Åó„Å¶„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ" aria-label="ÁîªÂÉè„Çí„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ">
                        <i data-lucide="image-plus"></i>
                    </button>
                    <input type="file" id="image-file-input" accept="image/*" style="display: none;">
                    <button id="send-escape-btn" class="console-btn" title="Escape„Ç≠„Éº„ÇíÈÄÅ‰ø°">
                        <i data-lucide="x-octagon"></i>
                    </button>
                    <button id="send-clear-btn" class="console-btn" title="ÁîªÈù¢„ÇØ„É™„Ç¢ (Ctrl+L)">
                        <i data-lucide="eraser"></i>
                    </button>
                    <button id="copy-terminal-btn" class="console-btn" title="„Çø„Éº„Éü„Éä„É´ÂÜÖÂÆπ„Çí„Ç≥„Éî„Éº">
                        <i data-lucide="copy"></i>
                    </button>
                </div>
                <iframe id="terminal-frame" src="about:blank" style="width: 100%; height: 100%; border: none;"></iframe>
                <div id="menu-overlay" class="menu-overlay hidden"></div>
                <div id="drop-overlay" class="drop-overlay">
                    <div class="drop-overlay-content">
                        <i data-lucide="upload"></i>
                        <span>„Éï„Ç°„Ç§„É´„Çí„Éâ„É≠„ÉÉ„Éó„Åó„Å¶„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ</span>
                    </div>
                </div>

                <!-- Phase 3.2: Choice Overlay for tapping terminal choices -->
                <div id="choice-overlay" class="choice-overlay">
                    <div class="choice-overlay-content">
                        <div class="choice-header">
                            <h3>ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</h3>
                            <button class="choice-close-btn" id="close-choice-overlay">
                                <i data-lucide="x"></i>
                            </button>
                        </div>
                        <div id="choice-buttons" class="choice-buttons">
                            <!-- Choices will be dynamically added here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Dashboard Panel (Phase 1) -->
            <div class="main-panel" id="dashboard-panel" style="display: none;">
                <div class="dashboard-container">
                    <!-- Section 1: ÂÅ•ÂÖ®ÊÄß„Ç≤„Éº„Ç∏Ôºà4„Å§Ôºâ -->
                    <section class="health-gauges">
                        <div id="gauge-1" class="gauge-chart"></div>
                        <div id="gauge-2" class="gauge-chart"></div>
                        <div id="gauge-3" class="gauge-chart"></div>
                        <div id="gauge-4" class="gauge-chart"></div>
                    </section>

                    <!-- Section 2: „Çµ„Éû„É™„Éº„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ -->
                    <section class="summary-dashboard">
                        <div class="metrics-left">
                            <!-- ‰∏ªË¶Å„É°„Éà„É™„ÇØ„Çπ4„Å§ will be injected via JS -->
                        </div>
                        <div class="donut-center">
                            <!-- ÂÖ®‰ΩìÂÅ•ÂÖ®ÊÄß„Éâ„Éº„Éä„ÉÑ will be injected via JS -->
                        </div>
                        <div class="donuts-right">
                            <!-- ÂïèÈ°å„Éó„É≠„Ç∏„Çß„ÇØ„Éà2„Å§ will be injected via JS -->
                        </div>
                    </section>

                    <!-- Section 3: „Éó„É≠„Ç∏„Çß„ÇØ„Éà„Ç´„Éº„Éâ„Ç∞„É™„ÉÉ„Éâ -->
                    <section class="project-cards-grid">
                        <!-- 12„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Ç´„Éº„Éâ will be injected via JS -->
                    </section>

                    <!-- Section 4: ÂÅ•ÂÖ®ÊÄß„Éí„Éº„Éà„Éû„ÉÉ„Éó (Phase 2) -->
                    <section class="health-heatmap-section" style="margin-top: 32px;">
                        <div class="section-header" style="margin-bottom: 16px;">
                            <h3
                                style="color: var(--text-secondary); font-size: 14px; text-transform: uppercase; letter-spacing: 0.05em;">
                                Projects Health Trend (Last 4 Weeks)</h3>
                        </div>
                        <div class="health-heatmap-container"
                            style="background: rgba(255, 255, 255, 0.02); padding: 20px; border-radius: 12px; border: 1px solid var(--border-color);">
                            <!-- Heatmap rows injected via JS -->
                        </div>
                    </section>

                    <!-- Section 5: „Ç∑„Çπ„ÉÜ„É†„É™„ÇΩ„Éº„Çπ (Phase 2) -->
                    <section class="system-resources-section" style="margin-top: 32px; margin-bottom: 40px;">
                        <div class="section-header" style="margin-bottom: 16px;">
                            <h3
                                style="color: var(--text-secondary); font-size: 14px; text-transform: uppercase; letter-spacing: 0.05em;">
                                System Resources</h3>
                        </div>
                        <div class="system-grid">
                            <!-- System gauges injected via JS -->
                        </div>

                        <!-- System Health Status -->
                        <div class="system-health-section" style="margin-top: 20px;">
                            <h4 style="color: var(--text-secondary); font-size: 13px; margin-bottom: 12px; font-weight: 600;">System Health</h4>
                            <div id="system-health-status"></div>
                        </div>
                    </section>

                    <!-- Section 6: Trend Graphs (Phase 3) -->
                    <section class="trend-graphs-section" style="margin-top: 32px; margin-bottom: 40px;">
                        <div class="section-header" style="margin-bottom: 16px;">
                            <h3
                                style="color: var(--text-secondary); font-size: 14px; text-transform: uppercase; letter-spacing: 0.05em;">
                                Overall Trends</h3>
                        </div>
                        <div class="trend-grid">
                            <div class="trend-wrapper">
                                <h4
                                    style="color:var(--text-primary); font-size:0.9rem; margin-bottom:12px; font-weight:600;">
                                    Overall Completion</h4>
                                <div class="trend-card" id="trend-completion"></div>
                            </div>
                            <div class="trend-wrapper">
                                <h4
                                    style="color:var(--text-primary); font-size:0.9rem; margin-bottom:12px; font-weight:600;">
                                    Overdue Tasks</h4>
                                <div class="trend-card" id="trend-overdue"></div>
                            </div>
                            <div class="trend-wrapper">
                                <h4
                                    style="color:var(--text-primary); font-size:0.9rem; margin-bottom:12px; font-weight:600;">
                                    Mana Success Rate</h4>
                                <div class="trend-card" id="trend-mana"></div>
                            </div>
                        </div>
                    </section>

                    <!-- Section 7: Mana Dashboard (Phase 4) -->
                    <section class="mana-dashboard-section">
                        <div class="section-header">
                            <h2><i data-lucide="bot"></i> Mana Dashboard</h2>
                            <p class="section-description">Slack AI PM„Ç®„Éº„Ç∏„Çß„É≥„Éà„ÅÆ„ÉØ„Éº„ÇØ„Éï„É≠„ÉºÂÆüË°åÁä∂Ê≥Å„Å®ÂìÅË≥™„É°„Éà„É™„ÇØ„Çπ</p>
                        </div>

                        <!-- Mana Hero Status -->
                        <div class="mana-hero" id="mana-hero">
                            <div class="loading">Ë™≠„ÅøËæº„Åø‰∏≠...</div>
                        </div>

                        <!-- Mana Quality Metrics (4 Gauges) -->
                        <div class="mana-quality-section">
                            <h3 class="subsection-title">ÂìÅË≥™„É°„Éà„É™„ÇØ„Çπ</h3>
                            <div class="mana-quality-grid" id="mana-quality-grid">
                                <div class="loading">Ë™≠„ÅøËæº„Åø‰∏≠...</div>
                            </div>
                        </div>

                        <!-- Mana Workflow Status -->
                        <div class="mana-workflows-section">
                            <h3 class="subsection-title">„ÉØ„Éº„ÇØ„Éï„É≠„ÉºÂÆüË°åÁä∂Ê≥Å</h3>
                            <div class="mana-workflows-grid" id="mana-workflows-grid">
                                <div class="loading">Ë™≠„ÅøËæº„Åø‰∏≠...</div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>

        </main>

        <!-- Right Sidebar (Context: Today's Page) -->
        <aside class="context-sidebar" id="context-sidebar">

            <!-- Focus Section: ÊúÄÈáçË¶Å„Çø„Çπ„ÇØ1„Å§ -->
            <div class="focus-section" id="focus-section">
                <div class="section-header">
                    <h3><i data-lucide="target"></i> ‰ªäÊó•„ÅÆ„Éï„Ç©„Éº„Ç´„Çπ</h3>
                </div>
                <div id="focus-task">
                    <div class="loading">Ë™≠„ÅøËæº„Åø‰∏≠...</div>
                </div>
            </div>

            <!-- Timeline Section: ‰∫àÂÆö+„Çø„Çπ„ÇØÁµ±Âêà -->
            <div class="timeline-section" id="timeline-section">
                <div class="section-header">
                    <h3><i data-lucide="calendar"></i> „Çø„Ç§„É†„É©„Ç§„É≥</h3>
                </div>
                <div id="timeline-list">
                    <div class="loading">Ë™≠„ÅøËæº„Åø‰∏≠...</div>
                </div>
            </div>

            <!-- Next Tasks Section: ÊÆã„Çä„ÅÆ„Çø„Çπ„ÇØ -->
            <div class="next-tasks-section" id="next-tasks-section">
                <div class="section-header">
                    <h3><i data-lucide="list-todo"></i> Ê¨°„Å´„ÇÑ„Çã„Åì„Å®</h3>
                    <button id="toggle-all-tasks" class="icon-btn" title="ÂÖ®„Å¶Ë°®Á§∫" aria-label="ÂÖ®„Å¶„ÅÆ„Çø„Çπ„ÇØ„ÇíË°®Á§∫">
                        <i data-lucide="chevron-down"></i>
                    </button>
                </div>
                <div class="task-filter">
                    <div class="filter-group">
                        <label for="task-filter-input" class="sr-only">„Çø„Çπ„ÇØ„Éï„Ç£„É´„Çø„Éº</label>
                        <input type="text" id="task-filter-input" placeholder="„Çø„Çπ„ÇØ„ÇíÊ§úÁ¥¢..." aria-label="„Çø„Çπ„ÇØÂêç„Åæ„Åü„ÅØË™¨Êòé„ÅßÊ§úÁ¥¢" />
                    </div>

                    <div class="filter-group">
                        <label for="priority-filter" class="sr-only">ÂÑ™ÂÖàÂ∫¶„Éï„Ç£„É´„Çø„Éº</label>
                        <select id="priority-filter" class="priority-filter" aria-label="ÂÑ™ÂÖàÂ∫¶„Åß„Éï„Ç£„É´„Çø">
                            <option value="">„Åô„Åπ„Å¶</option>
                            <option value="high">üî¥ È´ò</option>
                            <option value="medium">üü° ‰∏≠</option>
                            <option value="low">üîµ ‰Ωé</option>
                        </select>
                    </div>
                </div>
                <div id="next-tasks-list">
                    <div class="loading">Ë™≠„ÅøËæº„Åø‰∏≠...</div>
                </div>
                <div id="remaining-tasks-toggle" class="remaining-toggle" style="display: none;">
                    <button id="show-more-tasks">‰ªñ <span id="remaining-count">0</span> ‰ª∂„ÇíË°®Á§∫</button>
                </div>
            </div>
        </aside>
    </div>

    <footer class="app-footer">
        <div class="footer-controls">
            <button id="focus-btn" class="btn-primary"><i data-lucide="play"></i> „Éï„Ç©„Éº„Ç´„ÇπÈñãÂßã</button>
            <button id="pomodoro-btn" class="btn-secondary"><i data-lucide="timer"></i> „Éù„É¢„Éâ„Éº„É≠</button>
        </div>
        <div class="footer-actions">
            <button onclick="location.reload()" class="icon-btn"><i data-lucide="refresh-cw"></i></button>
            <button class="icon-btn"><i data-lucide="settings"></i></button>
        </div>
    </footer>

    <!-- Terminal Copy Modal -->
    <div id="copy-terminal-modal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3>„Çø„Éº„Éü„Éä„É´Âá∫Âäõ</h3>
                <div class="modal-header-actions">
                    <button id="copy-content-btn" class="btn-primary btn-sm"><i data-lucide="copy"></i> „Ç≥„Éî„Éº</button>
                    <button class="close-modal-btn"><i data-lucide="x"></i></button>
                </div>
            </div>
            <div class="modal-body">
                <pre id="terminal-content-display" class="terminal-content"></pre>
            </div>
        </div>
    </div>

    <!-- Paste Confirm Modal (Phase 2.2) -->
    <div id="paste-confirm-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>„ÉÜ„Ç≠„Çπ„Éà„Çí„Çø„Éº„Éü„Éä„É´„Å´Ë≤º„Çä‰ªò„Åë</h3>
                <button class="close-modal-btn"><i data-lucide="x"></i></button>
            </div>
            <div class="modal-body">
                <p class="modal-description">‰ª•‰∏ã„ÅÆ„ÉÜ„Ç≠„Çπ„Éà„Çí„Çø„Éº„Éü„Éä„É´„Å´Ë≤º„Çä‰ªò„Åë„Åæ„Åô„ÅãÔºü</p>
                <pre id="paste-preview-text" class="paste-preview"></pre>
            </div>
            <div class="modal-footer">
                <button id="paste-cancel-btn" class="btn-secondary">„Ç≠„É£„É≥„Çª„É´</button>
                <button id="paste-confirm-btn" class="btn-primary">Ë≤º„Çä‰ªò„Åë</button>
            </div>
        </div>
    </div>

    <!-- Edit Task Modal -->
    <div id="edit-task-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Task</h3>
                <button class="close-modal-btn"><i data-lucide="x"></i></button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="edit-task-id">
                <div class="form-group">
                    <label>Title</label>
                    <input type="text" id="edit-task-title" class="form-input">
                </div>
                <div class="form-group">
                    <label>Project</label>
                    <select id="edit-task-project" class="form-input">
                        <option value="brainbase">brainbase</option>
                        <option value="unson">unson</option>
                        <option value="tech-knight">tech-knight</option>
                        <option value="salestailor">salestailor</option>
                        <option value="zeims">zeims</option>
                        <option value="baao">baao</option>
                        <option value="ncom">ncom</option>
                        <option value="general">general</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Priority</label>
                    <select id="edit-task-priority" class="form-input">
                        <option value="high">High</option>
                        <option value="medium">Medium</option>
                        <option value="low">Low</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Due Date</label>
                    <input type="date" id="edit-task-due" class="form-input">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary close-modal-btn">Cancel</button>
                <button id="save-task-btn" class="btn-primary">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Rename Session Modal -->
    <div id="rename-session-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i data-lucide="edit-3"></i> „Çª„ÉÉ„Ç∑„Éß„É≥ÂêçÂ§âÊõ¥</h3>
                <button class="close-modal-btn"><i data-lucide="x"></i></button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="rename-session-input">„Çª„ÉÉ„Ç∑„Éß„É≥Âêç</label>
                    <input type="text" id="rename-session-input" class="form-input" placeholder="„Çª„ÉÉ„Ç∑„Éß„É≥Âêç„ÇíÂÖ•Âäõ">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary close-modal-btn">„Ç≠„É£„É≥„Çª„É´</button>
                <button class="btn-primary" id="save-rename-btn">‰øùÂ≠ò</button>
            </div>
        </div>
    </div>

    <!-- Create Session Modal -->
    <div id="create-session-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i data-lucide="plus-circle"></i> Êñ∞Ë¶è„Çª„ÉÉ„Ç∑„Éß„É≥</h3>
                <button class="close-modal-btn"><i data-lucide="x"></i></button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="session-name-input">„Çª„ÉÉ„Ç∑„Éß„É≥Âêç</label>
                    <input type="text" id="session-name-input" class="form-input" placeholder="„Çª„ÉÉ„Ç∑„Éß„É≥Âêç„ÇíÂÖ•Âäõ">
                </div>
                <div class="form-group">
                    <label for="session-project-select">„Éó„É≠„Ç∏„Çß„ÇØ„Éà</label>
                    <select id="session-project-select" class="form-input">
                        <option value="general">general</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="session-command-input">ÂàùÊúü„Ç≥„Éû„É≥„ÉâÔºàÁúÅÁï•ÂèØÔºâ</label>
                    <input type="text" id="session-command-input" class="form-input" placeholder="‰æã: /task 123">
                </div>
                <div class="form-group">
                    <label>AI Engine</label>
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="session-engine" value="claude" checked>
                            <span>Claude Code</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="session-engine" value="codex">
                            <span>OpenAI Codex</span>
                        </label>
                    </div>
                </div>
                <div class="form-group" id="worktree-option-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="use-worktree-checkbox">
                        <span>Git worktree„Çí‰ΩøÁî®</span>
                    </label>
                    <p class="form-hint" id="worktree-hint">„Éñ„É©„É≥„ÉÅ„ÇíÂàÜÈõ¢„Åó„Å¶ÂÆâÂÖ®„Å´‰ΩúÊ•≠„Åß„Åç„Åæ„Åô</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary close-modal-btn">„Ç≠„É£„É≥„Çª„É´</button>
                <button class="btn-primary" id="create-session-btn">‰ΩúÊàê</button>
            </div>
        </div>
    </div>

    <!-- Focus Engine Modal -->
    <div id="focus-engine-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i data-lucide="split"></i> „Éï„Ç©„Éº„Ç´„Çπ„ÅÆËµ∑ÂãïÂÖà</h3>
                <button class="close-modal-btn"><i data-lucide="x"></i></button>
            </div>
            <div class="modal-body">
                <p>‰ªäÊó•„ÅÆ„Éï„Ç©„Éº„Ç´„Çπ„Çí„Å©„ÅÆ„Ç®„É≥„Ç∏„É≥„ÅßÁ´ã„Å°‰∏ä„Åí„Åæ„Åô„ÅãÔºü</p>
                <div class="engine-select-grid">
                    <button class="engine-select-btn btn-primary" data-engine="claude">
                        <i data-lucide="sparkles"></i> Claude Code
                    </button>
                    <button class="engine-select-btn btn-secondary" data-engine="codex">
                        <i data-lucide="boxes"></i> OpenAI Codex
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Archive Sessions Modal -->
    <div id="archive-modal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3><i data-lucide="archive"></i> ÈÅéÂéª„ÅÆ„Çª„ÉÉ„Ç∑„Éß„É≥</h3>
                <button class="close-modal-btn"><i data-lucide="x"></i></button>
            </div>
            <div class="modal-body">
                <div class="archive-filters">
                    <input type="text" id="archive-search" class="form-input" placeholder="„Çª„ÉÉ„Ç∑„Éß„É≥Âêç„ÅßÊ§úÁ¥¢...">
                    <select id="archive-project-filter" class="form-input">
                        <option value="">„Åô„Åπ„Å¶„ÅÆ„Éó„É≠„Ç∏„Çß„ÇØ„Éà</option>
                    </select>
                </div>
                <div id="archive-list" class="archive-list">
                    <!-- Archived sessions will be loaded here -->
                </div>
                <div id="archive-empty" class="archive-empty" style="display: none;">
                    <i data-lucide="inbox"></i>
                    <p>„Ç¢„Éº„Ç´„Ç§„Éñ„Åï„Çå„Åü„Çª„ÉÉ„Ç∑„Éß„É≥„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal">
        <div class="modal-content modal-fullscreen" id="settings-view">
            <div class="modal-header settings-header">
                <h3><i data-lucide="settings"></i> Settings</h3>
                <div style="display: flex; gap: 8px;">
                    <button class="icon-btn" id="restart-server-btn" title="Restart Server">
                        <i data-lucide="refresh-cw"></i>
                    </button>
                    <button class="close-modal-btn" id="close-settings-btn"><i data-lucide="x"></i></button>
                </div>
            </div>
            <div class="modal-body settings-body">
                <!-- Integrity Summary -->
                <div class="integrity-summary" id="integrity-summary">
                    <div class="loading">Loading...</div>
                </div>

                <!-- Settings Tabs -->
                <div class="settings-tabs">
                    <button class="settings-tab active" data-tab="unified">
                        <i data-lucide="layout-grid"></i> Overview
                    </button>
                    <button class="settings-tab" data-tab="slack">
                        <i data-lucide="hash"></i> Slack
                    </button>
                    <button class="settings-tab" data-tab="projects">
                        <i data-lucide="folder-git-2"></i> Projects
                    </button>
                    <button class="settings-tab" data-tab="github">
                        <i data-lucide="github"></i> GitHub
                    </button>
                    <button class="settings-tab" data-tab="nocodb">
                        <i data-lucide="table-2"></i> NocoDB
                    </button>
                </div>

                <!-- Tab Content -->
                <div class="settings-content">
                    <!-- Unified Overview Tab -->
                    <div class="settings-panel active" id="unified-panel">
                        <div class="settings-section">
                            <h3>Unified Configuration Overview</h3>
                            <p class="settings-section-desc">Workspace ‚Üí Project ‚Üí Slack/GitHub/Airtable „ÅÆÁµ±Âêà„Éû„ÉÉ„Éî„É≥„Ç∞</p>
                            <div id="unified-view" class="config-table-container">
                                <div class="loading">Loading...</div>
                            </div>
                        </div>
                    </div>

                    <!-- Slack Tab -->
                    <div class="settings-panel" id="slack-panel">
                        <div class="settings-section">
                            <h3>Workspaces</h3>
                            <div id="workspaces-list" class="config-list">
                                <div class="loading">Loading...</div>
                            </div>
                        </div>

                        <div class="settings-section">
                            <h3>Channel Mappings</h3>
                            <div class="filter-bar">
                                <input type="text" id="channel-filter" placeholder="Search channels..."
                                    class="form-input">
                                <select id="workspace-filter" class="form-input">
                                    <option value="">All Workspaces</option>
                                </select>
                            </div>
                            <div id="channels-list" class="config-table-container">
                                <div class="loading">Loading...</div>
                            </div>
                        </div>

                        <div class="settings-section">
                            <h3>Member Mappings</h3>
                            <div class="filter-bar">
                                <input type="text" id="member-filter" placeholder="Search members..."
                                    class="form-input">
                            </div>
                            <div id="members-list" class="config-table-container">
                                <div class="loading">Loading...</div>
                            </div>
                        </div>
                    </div>

                    <!-- Projects Tab -->
                    <div class="settings-panel" id="projects-panel">
                        <div class="settings-section">
                            <h3>Project Mappings</h3>
                            <div id="projects-list" class="config-table-container">
                                <div class="loading">Loading...</div>
                            </div>
                        </div>
                    </div>

                    <!-- GitHub Tab -->
                    <div class="settings-panel" id="github-panel">
                        <div class="settings-section">
                            <h3>GitHub Repository Mappings</h3>
                            <p class="settings-section-desc">„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Å®GitHub„É™„Éù„Ç∏„Éà„É™„ÅÆÂØæÂøúÈñ¢‰øÇÔºàÊ≠£Êú¨: config.ymlÔºâ</p>
                            <div id="github-list" class="config-table-container">
                                <div class="loading">Loading...</div>
                            </div>
                        </div>
                    </div>

                    <!-- NocoDB Tab -->
                    <div class="settings-panel" id="nocodb-panel">
                        <div class="settings-section">
                            <h3>NocoDB Base Mappings</h3>
                            <p class="settings-section-desc">„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Å®NocoDB„Éô„Éº„Çπ„ÅÆÂØæÂøúÈñ¢‰øÇÔºàÊ≠£Êú¨: config.ymlÔºâ</p>
                            <div id="nocodb-list" class="config-table-container">
                                <div class="loading">Loading...</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Confirm Modal -->
    <div id="confirm-modal" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h3 id="confirm-modal-title"><i data-lucide="alert-circle"></i> Á¢∫Ë™ç</h3>
                <button class="close-modal-btn"><i data-lucide="x"></i></button>
            </div>
            <div class="modal-body">
                <p id="confirm-modal-message"></p>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="confirm-cancel-btn">„Ç≠„É£„É≥„Çª„É´</button>
                <button class="btn-danger" id="confirm-ok-btn">OK</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container"></div>

    <!-- Mobile Software Keyboard (for choice navigation) -->
    <div id="mobile-keyboard" class="mobile-keyboard">
        <button class="keyboard-key" id="key-up" title="‰∏äÁü¢Âç∞">
            <i data-lucide="arrow-up"></i>
        </button>
        <button class="keyboard-key" id="key-down" title="‰∏ãÁü¢Âç∞">
            <i data-lucide="arrow-down"></i>
        </button>
        <button class="keyboard-key" id="key-tab" title="Tab">
            <span class="key-label">Tab</span>
        </button>
        <button class="keyboard-key keyboard-key-primary" id="key-enter" title="Enter">
            <i data-lucide="corner-down-left"></i>
            <span class="key-label">Enter</span>
        </button>
    </div>

    <!-- Mobile Bottom Navigation (hidden on desktop) -->
    <nav class="mobile-bottom-nav" id="mobile-bottom-nav">
        <button id="mobile-sessions-btn">
            <i data-lucide="layers"></i>
            <span>Sessions</span>
        </button>
        <button id="mobile-tasks-btn">
            <i data-lucide="list-todo"></i>
            <span>Tasks</span>
        </button>
        <button id="mobile-settings-btn">
            <i data-lucide="settings"></i>
            <span>Settings</span>
        </button>
    </nav>

    <!-- Sessions Bottom Sheet -->
    <div id="sessions-sheet-overlay" class="bottom-sheet-overlay"></div>
    <div id="sessions-bottom-sheet" class="bottom-sheet">
        <div class="bottom-sheet-handle"></div>
        <div class="bottom-sheet-header">
            <h3 id="mobile-app-version" class="mobile-version-display">v0.1.86</h3>
            <button class="add-session-btn-icon" id="mobile-add-session-btn" title="New Session">
                <i data-lucide="plus"></i>
            </button>
            <button class="bottom-sheet-close" id="close-sessions-sheet">
                <i data-lucide="x"></i>
            </button>
        </div>
        <div class="archive-toggle-container" style="padding: 0.5rem 1rem;">
            <button id="mobile-toggle-archived-btn" class="archive-toggle-btn">
                <i data-lucide="archive"></i>
                <span>„Ç¢„Éº„Ç´„Ç§„Éñ„ÇíË°®Á§∫</span>
            </button>
        </div>
        <div class="bottom-sheet-content" id="mobile-session-list">
            <!-- Sessions will be cloned here -->
        </div>
    </div>

    <!-- Tasks Bottom Sheet -->
    <div id="tasks-sheet-overlay" class="bottom-sheet-overlay"></div>
    <div id="tasks-bottom-sheet" class="bottom-sheet">
        <div class="bottom-sheet-handle"></div>
        <div class="bottom-sheet-header">
            <h3><i data-lucide="list-todo"></i> Tasks</h3>
            <button class="bottom-sheet-close" id="close-tasks-sheet">
                <i data-lucide="x"></i>
            </button>
        </div>
        <div class="bottom-sheet-content" id="mobile-tasks-content">
            <!-- Tasks will be cloned here -->
        </div>
    </div>

    <!-- Mobile FAB (Floating Action Button) with Speed Dial -->
    <div id="mobile-fab-container" class="mobile-fab-container">
        <!-- Overlay to close menu -->
        <div id="mobile-fab-overlay" class="mobile-fab-overlay"></div>

        <!-- Speed Dial Actions (ordered bottom-to-top by usage frequency) -->
        <div id="mobile-fab-actions" class="mobile-fab-actions">
            <!-- Least frequent: Copy (top, farthest from FAB) -->
            <button class="mobile-fab-action" id="mobile-copy-terminal-btn" title="„Çø„Éº„Éü„Éä„É´ÂÜÖÂÆπ„Çí„Ç≥„Éî„Éº">
                <i data-lucide="copy"></i>
                <span class="fab-action-label">„Ç≥„Éî„Éº</span>
            </button>
            <!-- Low frequency: Clear -->
            <button class="mobile-fab-action" id="mobile-send-clear-btn" title="ÁîªÈù¢„ÇØ„É™„Ç¢ (Ctrl+L)">
                <i data-lucide="eraser"></i>
                <span class="fab-action-label">„ÇØ„É™„Ç¢</span>
            </button>
            <!-- Medium frequency: Escape -->
            <button class="mobile-fab-action" id="mobile-send-escape-btn" title="Escape„Ç≠„Éº„ÇíÈÄÅ‰ø°">
                <i data-lucide="x-octagon"></i>
                <span class="fab-action-label">Escape</span>
            </button>
            <!-- Mode toggle: Shift+Tab for plan mode -->
            <button class="mobile-fab-action" id="mobile-send-shift-tab-btn" title="Shift+Tab„ÇíÈÄÅ‰ø°Ôºà„Éó„É©„É≥„É¢„Éº„ÉâÂàá„ÇäÊõø„ÅàÔºâ">
                <i data-lucide="panel-left"></i>
                <span class="fab-action-label">„Éó„É©„É≥</span>
            </button>
            <!-- Mode toggle: Virtual keyboard visibility -->
            <button class="mobile-fab-action" id="mobile-toggle-keyboard-btn" title="‰ªÆÊÉ≥„Ç≠„Éº„Éú„Éº„ÉâË°®Á§∫/ÈùûË°®Á§∫">
                <i data-lucide="keyboard"></i>
                <span class="fab-action-label">„Ç≠„Éº„Éú„Éº„Éâ</span>
            </button>
            <!-- High frequency: Image upload -->
            <button class="mobile-fab-action" id="mobile-upload-image-btn" title="ÁîªÂÉè„ÇíÈÅ∏Êäû„Åó„Å¶„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ">
                <i data-lucide="image-plus"></i>
                <span class="fab-action-label">ÁîªÂÉè</span>
            </button>
            <!-- Most frequent: Paste (bottom, closest to FAB) -->
            <button class="mobile-fab-action" id="mobile-paste-btn" title="„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Åã„Çâ„Éö„Éº„Çπ„Éà">
                <i data-lucide="clipboard"></i>
                <span class="fab-action-label">„Éö„Éº„Çπ„Éà</span>
            </button>
        </div>

        <!-- Main FAB Button -->
        <button id="mobile-fab" class="mobile-fab" title="„Ç¢„ÇØ„Ç∑„Éß„É≥„É°„Éã„É•„Éº">
            <i data-lucide="wrench" class="fab-icon-default"></i>
            <i data-lucide="x" class="fab-icon-close"></i>
        </button>
    </div>

    <!-- Health Detail Modal -->
    <div id="health-detail-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="window.dashboardController.closeHealthModal()">&times;</span>
            <div id="health-modal-content"></div>
        </div>
    </div>

    <script type="module" src="app.js?v=1766798000"></script>
    <script>
        lucide.createIcons();
    </script>
</body>

</html>